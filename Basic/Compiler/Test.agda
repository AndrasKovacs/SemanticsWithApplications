
module Basic.Compiler.Test where

open import Basic.AST
open import Basic.Compiler.Code
open import Basic.Compiler.Machine
open import Basic.BigStep

open import Data.Fin
open import Data.Nat
open import Data.Vec
open import Data.Product
open import Data.Bool
open import Data.List

open Basic.BigStep.Fac

{- Just a sandbox for testing the interpreters in Compiler.Machine -}

fac' : Code 3
fac' = ùìí‚ü¶ fac ‚üßÀ¢ 

test = trace fac' [] (1 ‚à∑ 0 ‚à∑ 0 ‚à∑ []) 1000

-- normal form of "test"

-- (PUSH 0 ‚à∑
--  STORE (suc zero) ‚à∑
--  PUSH 1 ‚à∑
--  STORE (suc (suc zero)) ‚à∑
--  LOOP (FETCH zero ‚à∑ FETCH (suc zero) ‚à∑ LT ‚à∑ [])
--  (FETCH (suc zero) ‚à∑
--   PUSH 1 ‚à∑
--   ADD ‚à∑
--   STORE (suc zero) ‚à∑
--   FETCH (suc (suc zero)) ‚à∑
--   FETCH (suc zero) ‚à∑ MUL ‚à∑ STORE (suc (suc zero)) ‚à∑ [])
--  ‚à∑ []
--  , [] , 1 ‚à∑ 0 ‚à∑ 0 ‚à∑ [])
-- ‚à∑
-- (STORE (suc zero) ‚à∑
--  PUSH 1 ‚à∑
--  STORE (suc (suc zero)) ‚à∑
--  LOOP (FETCH zero ‚à∑ FETCH (suc zero) ‚à∑ LT ‚à∑ [])
--  (FETCH (suc zero) ‚à∑
--   PUSH 1 ‚à∑
--   ADD ‚à∑
--   STORE (suc zero) ‚à∑
--   FETCH (suc (suc zero)) ‚à∑
--   FETCH (suc zero) ‚à∑ MUL ‚à∑ STORE (suc (suc zero)) ‚à∑ [])
--  ‚à∑ []
--  , nat 0 ‚à∑ [] , 1 ‚à∑ 0 ‚à∑ 0 ‚à∑ [])
-- ‚à∑
-- (PUSH 1 ‚à∑
--  STORE (suc (suc zero)) ‚à∑
--  LOOP (FETCH zero ‚à∑ FETCH (suc zero) ‚à∑ LT ‚à∑ [])
--  (FETCH (suc zero) ‚à∑
--   PUSH 1 ‚à∑
--   ADD ‚à∑
--   STORE (suc zero) ‚à∑
--   FETCH (suc (suc zero)) ‚à∑
--   FETCH (suc zero) ‚à∑ MUL ‚à∑ STORE (suc (suc zero)) ‚à∑ [])
--  ‚à∑ []
--  , [] , 1 ‚à∑ 0 ‚à∑ 0 ‚à∑ [])
-- ‚à∑
-- (STORE (suc (suc zero)) ‚à∑
--  LOOP (FETCH zero ‚à∑ FETCH (suc zero) ‚à∑ LT ‚à∑ [])
--  (FETCH (suc zero) ‚à∑
--   PUSH 1 ‚à∑
--   ADD ‚à∑
--   STORE (suc zero) ‚à∑
--   FETCH (suc (suc zero)) ‚à∑
--   FETCH (suc zero) ‚à∑ MUL ‚à∑ STORE (suc (suc zero)) ‚à∑ [])
--  ‚à∑ []
--  , nat 1 ‚à∑ [] , 1 ‚à∑ 0 ‚à∑ 0 ‚à∑ [])
-- ‚à∑
-- (LOOP (FETCH zero ‚à∑ FETCH (suc zero) ‚à∑ LT ‚à∑ [])
--  (FETCH (suc zero) ‚à∑
--   PUSH 1 ‚à∑
--   ADD ‚à∑
--   STORE (suc zero) ‚à∑
--   FETCH (suc (suc zero)) ‚à∑
--   FETCH (suc zero) ‚à∑ MUL ‚à∑ STORE (suc (suc zero)) ‚à∑ [])
--  ‚à∑ []
--  , [] , 1 ‚à∑ 0 ‚à∑ 1 ‚à∑ [])
-- ‚à∑
-- (FETCH zero ‚à∑
--  FETCH (suc zero) ‚à∑
--  LT ‚à∑
--  BRANCH
--  (FETCH (suc zero) ‚à∑
--   PUSH 1 ‚à∑
--   ADD ‚à∑
--   STORE (suc zero) ‚à∑
--   FETCH (suc (suc zero)) ‚à∑
--   FETCH (suc zero) ‚à∑
--   MUL ‚à∑
--   STORE (suc (suc zero)) ‚à∑
--   LOOP (FETCH zero ‚à∑ FETCH (suc zero) ‚à∑ LT ‚à∑ [])
--   (FETCH (suc zero) ‚à∑
--    PUSH 1 ‚à∑
--    ADD ‚à∑
--    STORE (suc zero) ‚à∑
--    FETCH (suc (suc zero)) ‚à∑
--    FETCH (suc zero) ‚à∑ MUL ‚à∑ STORE (suc (suc zero)) ‚à∑ [])
--   ‚à∑ [])
--  (NOOP ‚à∑ [])
--  ‚à∑ []
--  , [] , 1 ‚à∑ 0 ‚à∑ 1 ‚à∑ [])
-- ‚à∑
-- (FETCH (suc zero) ‚à∑
--  LT ‚à∑
--  BRANCH
--  (FETCH (suc zero) ‚à∑
--   PUSH 1 ‚à∑
--   ADD ‚à∑
--   STORE (suc zero) ‚à∑
--   FETCH (suc (suc zero)) ‚à∑
--   FETCH (suc zero) ‚à∑
--   MUL ‚à∑
--   STORE (suc (suc zero)) ‚à∑
--   LOOP (FETCH zero ‚à∑ FETCH (suc zero) ‚à∑ LT ‚à∑ [])
--   (FETCH (suc zero) ‚à∑
--    PUSH 1 ‚à∑
--    ADD ‚à∑
--    STORE (suc zero) ‚à∑
--    FETCH (suc (suc zero)) ‚à∑
--    FETCH (suc zero) ‚à∑ MUL ‚à∑ STORE (suc (suc zero)) ‚à∑ [])
--   ‚à∑ [])
--  (NOOP ‚à∑ [])
--  ‚à∑ []
--  , nat 1 ‚à∑ [] , 1 ‚à∑ 0 ‚à∑ 1 ‚à∑ [])
-- ‚à∑
-- (LT ‚à∑
--  BRANCH
--  (FETCH (suc zero) ‚à∑
--   PUSH 1 ‚à∑
--   ADD ‚à∑
--   STORE (suc zero) ‚à∑
--   FETCH (suc (suc zero)) ‚à∑
--   FETCH (suc zero) ‚à∑
--   MUL ‚à∑
--   STORE (suc (suc zero)) ‚à∑
--   LOOP (FETCH zero ‚à∑ FETCH (suc zero) ‚à∑ LT ‚à∑ [])
--   (FETCH (suc zero) ‚à∑
--    PUSH 1 ‚à∑
--    ADD ‚à∑
--    STORE (suc zero) ‚à∑
--    FETCH (suc (suc zero)) ‚à∑
--    FETCH (suc zero) ‚à∑ MUL ‚à∑ STORE (suc (suc zero)) ‚à∑ [])
--   ‚à∑ [])
--  (NOOP ‚à∑ [])
--  ‚à∑ []
--  , nat 0 ‚à∑ nat 1 ‚à∑ [] , 1 ‚à∑ 0 ‚à∑ 1 ‚à∑ [])
-- ‚à∑
-- (BRANCH
--  (FETCH (suc zero) ‚à∑
--   PUSH 1 ‚à∑
--   ADD ‚à∑
--   STORE (suc zero) ‚à∑
--   FETCH (suc (suc zero)) ‚à∑
--   FETCH (suc zero) ‚à∑
--   MUL ‚à∑
--   STORE (suc (suc zero)) ‚à∑
--   LOOP (FETCH zero ‚à∑ FETCH (suc zero) ‚à∑ LT ‚à∑ [])
--   (FETCH (suc zero) ‚à∑
--    PUSH 1 ‚à∑
--    ADD ‚à∑
--    STORE (suc zero) ‚à∑
--    FETCH (suc (suc zero)) ‚à∑
--    FETCH (suc zero) ‚à∑ MUL ‚à∑ STORE (suc (suc zero)) ‚à∑ [])
--   ‚à∑ [])
--  (NOOP ‚à∑ [])
--  ‚à∑ []
--  , bool true ‚à∑ [] , 1 ‚à∑ 0 ‚à∑ 1 ‚à∑ [])
-- ‚à∑
-- (FETCH (suc zero) ‚à∑
--  PUSH 1 ‚à∑
--  ADD ‚à∑
--  STORE (suc zero) ‚à∑
--  FETCH (suc (suc zero)) ‚à∑
--  FETCH (suc zero) ‚à∑
--  MUL ‚à∑
--  STORE (suc (suc zero)) ‚à∑
--  LOOP (FETCH zero ‚à∑ FETCH (suc zero) ‚à∑ LT ‚à∑ [])
--  (FETCH (suc zero) ‚à∑
--   PUSH 1 ‚à∑
--   ADD ‚à∑
--   STORE (suc zero) ‚à∑
--   FETCH (suc (suc zero)) ‚à∑
--   FETCH (suc zero) ‚à∑ MUL ‚à∑ STORE (suc (suc zero)) ‚à∑ [])
--  ‚à∑ []
--  , [] , 1 ‚à∑ 0 ‚à∑ 1 ‚à∑ [])
-- ‚à∑
-- (PUSH 1 ‚à∑
--  ADD ‚à∑
--  STORE (suc zero) ‚à∑
--  FETCH (suc (suc zero)) ‚à∑
--  FETCH (suc zero) ‚à∑
--  MUL ‚à∑
--  STORE (suc (suc zero)) ‚à∑
--  LOOP (FETCH zero ‚à∑ FETCH (suc zero) ‚à∑ LT ‚à∑ [])
--  (FETCH (suc zero) ‚à∑
--   PUSH 1 ‚à∑
--   ADD ‚à∑
--   STORE (suc zero) ‚à∑
--   FETCH (suc (suc zero)) ‚à∑
--   FETCH (suc zero) ‚à∑ MUL ‚à∑ STORE (suc (suc zero)) ‚à∑ [])
--  ‚à∑ []
--  , nat 0 ‚à∑ [] , 1 ‚à∑ 0 ‚à∑ 1 ‚à∑ [])
-- ‚à∑
-- (ADD ‚à∑
--  STORE (suc zero) ‚à∑
--  FETCH (suc (suc zero)) ‚à∑
--  FETCH (suc zero) ‚à∑
--  MUL ‚à∑
--  STORE (suc (suc zero)) ‚à∑
--  LOOP (FETCH zero ‚à∑ FETCH (suc zero) ‚à∑ LT ‚à∑ [])
--  (FETCH (suc zero) ‚à∑
--   PUSH 1 ‚à∑
--   ADD ‚à∑
--   STORE (suc zero) ‚à∑
--   FETCH (suc (suc zero)) ‚à∑
--   FETCH (suc zero) ‚à∑ MUL ‚à∑ STORE (suc (suc zero)) ‚à∑ [])
--  ‚à∑ []
--  , nat 1 ‚à∑ nat 0 ‚à∑ [] , 1 ‚à∑ 0 ‚à∑ 1 ‚à∑ [])
-- ‚à∑
-- (STORE (suc zero) ‚à∑
--  FETCH (suc (suc zero)) ‚à∑
--  FETCH (suc zero) ‚à∑
--  MUL ‚à∑
--  STORE (suc (suc zero)) ‚à∑
--  LOOP (FETCH zero ‚à∑ FETCH (suc zero) ‚à∑ LT ‚à∑ [])
--  (FETCH (suc zero) ‚à∑
--   PUSH 1 ‚à∑
--   ADD ‚à∑
--   STORE (suc zero) ‚à∑
--   FETCH (suc (suc zero)) ‚à∑
--   FETCH (suc zero) ‚à∑ MUL ‚à∑ STORE (suc (suc zero)) ‚à∑ [])
--  ‚à∑ []
--  , nat 1 ‚à∑ [] , 1 ‚à∑ 0 ‚à∑ 1 ‚à∑ [])
-- ‚à∑
-- (FETCH (suc (suc zero)) ‚à∑
--  FETCH (suc zero) ‚à∑
--  MUL ‚à∑
--  STORE (suc (suc zero)) ‚à∑
--  LOOP (FETCH zero ‚à∑ FETCH (suc zero) ‚à∑ LT ‚à∑ [])
--  (FETCH (suc zero) ‚à∑
--   PUSH 1 ‚à∑
--   ADD ‚à∑
--   STORE (suc zero) ‚à∑
--   FETCH (suc (suc zero)) ‚à∑
--   FETCH (suc zero) ‚à∑ MUL ‚à∑ STORE (suc (suc zero)) ‚à∑ [])
--  ‚à∑ []
--  , [] , 1 ‚à∑ 1 ‚à∑ 1 ‚à∑ [])
-- ‚à∑
-- (FETCH (suc zero) ‚à∑
--  MUL ‚à∑
--  STORE (suc (suc zero)) ‚à∑
--  LOOP (FETCH zero ‚à∑ FETCH (suc zero) ‚à∑ LT ‚à∑ [])
--  (FETCH (suc zero) ‚à∑
--   PUSH 1 ‚à∑
--   ADD ‚à∑
--   STORE (suc zero) ‚à∑
--   FETCH (suc (suc zero)) ‚à∑
--   FETCH (suc zero) ‚à∑ MUL ‚à∑ STORE (suc (suc zero)) ‚à∑ [])
--  ‚à∑ []
--  , nat 1 ‚à∑ [] , 1 ‚à∑ 1 ‚à∑ 1 ‚à∑ [])
-- ‚à∑
-- (MUL ‚à∑
--  STORE (suc (suc zero)) ‚à∑
--  LOOP (FETCH zero ‚à∑ FETCH (suc zero) ‚à∑ LT ‚à∑ [])
--  (FETCH (suc zero) ‚à∑
--   PUSH 1 ‚à∑
--   ADD ‚à∑
--   STORE (suc zero) ‚à∑
--   FETCH (suc (suc zero)) ‚à∑
--   FETCH (suc zero) ‚à∑ MUL ‚à∑ STORE (suc (suc zero)) ‚à∑ [])
--  ‚à∑ []
--  , nat 1 ‚à∑ nat 1 ‚à∑ [] , 1 ‚à∑ 1 ‚à∑ 1 ‚à∑ [])
-- ‚à∑
-- (STORE (suc (suc zero)) ‚à∑
--  LOOP (FETCH zero ‚à∑ FETCH (suc zero) ‚à∑ LT ‚à∑ [])
--  (FETCH (suc zero) ‚à∑
--   PUSH 1 ‚à∑
--   ADD ‚à∑
--   STORE (suc zero) ‚à∑
--   FETCH (suc (suc zero)) ‚à∑
--   FETCH (suc zero) ‚à∑ MUL ‚à∑ STORE (suc (suc zero)) ‚à∑ [])
--  ‚à∑ []
--  , nat 1 ‚à∑ [] , 1 ‚à∑ 1 ‚à∑ 1 ‚à∑ [])
-- ‚à∑
-- (LOOP (FETCH zero ‚à∑ FETCH (suc zero) ‚à∑ LT ‚à∑ [])
--  (FETCH (suc zero) ‚à∑
--   PUSH 1 ‚à∑
--   ADD ‚à∑
--   STORE (suc zero) ‚à∑
--   FETCH (suc (suc zero)) ‚à∑
--   FETCH (suc zero) ‚à∑ MUL ‚à∑ STORE (suc (suc zero)) ‚à∑ [])
--  ‚à∑ []
--  , [] , 1 ‚à∑ 1 ‚à∑ 1 ‚à∑ [])
-- ‚à∑
-- (FETCH zero ‚à∑
--  FETCH (suc zero) ‚à∑
--  LT ‚à∑
--  BRANCH
--  (FETCH (suc zero) ‚à∑
--   PUSH 1 ‚à∑
--   ADD ‚à∑
--   STORE (suc zero) ‚à∑
--   FETCH (suc (suc zero)) ‚à∑
--   FETCH (suc zero) ‚à∑
--   MUL ‚à∑
--   STORE (suc (suc zero)) ‚à∑
--   LOOP (FETCH zero ‚à∑ FETCH (suc zero) ‚à∑ LT ‚à∑ [])
--   (FETCH (suc zero) ‚à∑
--    PUSH 1 ‚à∑
--    ADD ‚à∑
--    STORE (suc zero) ‚à∑
--    FETCH (suc (suc zero)) ‚à∑
--    FETCH (suc zero) ‚à∑ MUL ‚à∑ STORE (suc (suc zero)) ‚à∑ [])
--   ‚à∑ [])
--  (NOOP ‚à∑ [])
--  ‚à∑ []
--  , [] , 1 ‚à∑ 1 ‚à∑ 1 ‚à∑ [])
-- ‚à∑
-- (FETCH (suc zero) ‚à∑
--  LT ‚à∑
--  BRANCH
--  (FETCH (suc zero) ‚à∑
--   PUSH 1 ‚à∑
--   ADD ‚à∑
--   STORE (suc zero) ‚à∑
--   FETCH (suc (suc zero)) ‚à∑
--   FETCH (suc zero) ‚à∑
--   MUL ‚à∑
--   STORE (suc (suc zero)) ‚à∑
--   LOOP (FETCH zero ‚à∑ FETCH (suc zero) ‚à∑ LT ‚à∑ [])
--   (FETCH (suc zero) ‚à∑
--    PUSH 1 ‚à∑
--    ADD ‚à∑
--    STORE (suc zero) ‚à∑
--    FETCH (suc (suc zero)) ‚à∑
--    FETCH (suc zero) ‚à∑ MUL ‚à∑ STORE (suc (suc zero)) ‚à∑ [])
--   ‚à∑ [])
--  (NOOP ‚à∑ [])
--  ‚à∑ []
--  , nat 1 ‚à∑ [] , 1 ‚à∑ 1 ‚à∑ 1 ‚à∑ [])
-- ‚à∑
-- (LT ‚à∑
--  BRANCH
--  (FETCH (suc zero) ‚à∑
--   PUSH 1 ‚à∑
--   ADD ‚à∑
--   STORE (suc zero) ‚à∑
--   FETCH (suc (suc zero)) ‚à∑
--   FETCH (suc zero) ‚à∑
--   MUL ‚à∑
--   STORE (suc (suc zero)) ‚à∑
--   LOOP (FETCH zero ‚à∑ FETCH (suc zero) ‚à∑ LT ‚à∑ [])
--   (FETCH (suc zero) ‚à∑
--    PUSH 1 ‚à∑
--    ADD ‚à∑
--    STORE (suc zero) ‚à∑
--    FETCH (suc (suc zero)) ‚à∑
--    FETCH (suc zero) ‚à∑ MUL ‚à∑ STORE (suc (suc zero)) ‚à∑ [])
--   ‚à∑ [])
--  (NOOP ‚à∑ [])
--  ‚à∑ []
--  , nat 1 ‚à∑ nat 1 ‚à∑ [] , 1 ‚à∑ 1 ‚à∑ 1 ‚à∑ [])
-- ‚à∑
-- (BRANCH
--  (FETCH (suc zero) ‚à∑
--   PUSH 1 ‚à∑
--   ADD ‚à∑
--   STORE (suc zero) ‚à∑
--   FETCH (suc (suc zero)) ‚à∑
--   FETCH (suc zero) ‚à∑
--   MUL ‚à∑
--   STORE (suc (suc zero)) ‚à∑
--   LOOP (FETCH zero ‚à∑ FETCH (suc zero) ‚à∑ LT ‚à∑ [])
--   (FETCH (suc zero) ‚à∑
--    PUSH 1 ‚à∑
--    ADD ‚à∑
--    STORE (suc zero) ‚à∑
--    FETCH (suc (suc zero)) ‚à∑
--    FETCH (suc zero) ‚à∑ MUL ‚à∑ STORE (suc (suc zero)) ‚à∑ [])
--   ‚à∑ [])
--  (NOOP ‚à∑ [])
--  ‚à∑ []
--  , bool false ‚à∑ [] , 1 ‚à∑ 1 ‚à∑ 1 ‚à∑ [])
-- ‚à∑
-- (NOOP ‚à∑ [] , [] , 1 ‚à∑ 1 ‚à∑ 1 ‚à∑ []) ‚à∑ ([] , [] , 1 ‚à∑ 1 ‚à∑ 1 ‚à∑ []) ‚à∑ []




